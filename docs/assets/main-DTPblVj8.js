import"./base-D7JJuB-E.js";import{l as y}from"./navbar-DIDQeqOs.js";/* empty css                   */import{s as v,t as x}from"./api-B5ytiBQV.js";let a=null;function u(e,t="success"){const n=document.querySelector(".custom-toast");n&&n.remove();const s=document.createElement("div");s.className=`custom-toast toast-${t}`;const i={success:`<svg class="toast-icon" viewBox="0 0 20 20" fill="currentColor">
      <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
    </svg>`,error:`<svg class="toast-icon" viewBox="0 0 20 20" fill="currentColor">
      <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"/>
    </svg>`,warning:`<svg class="toast-icon" viewBox="0 0 20 20" fill="currentColor">
      <path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd"/>
    </svg>`};s.innerHTML=`
    ${i[t]}
    <span class="toast-message">${e}</span>
    <button class="toast-close" aria-label="Close">
      <svg viewBox="0 0 20 20" fill="currentColor">
        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"/>
      </svg>
    </button>
  `,document.body.appendChild(s),setTimeout(()=>s.classList.add("show"),10),s.querySelector(".toast-close").addEventListener("click",()=>{s.classList.remove("show"),setTimeout(()=>s.remove(),300)}),setTimeout(()=>{s.parentElement&&(s.classList.remove("show"),setTimeout(()=>s.remove(),300))},5e3)}const P="xKnL-OvHIJbJ6pn8s",b="service_38razxb",k="template_aplhulr";function E(e){return e.replace(/[-\s]/g,"").toUpperCase()}async function h(e){const t=E(e),n=document.getElementById("kenteken-status"),s=document.getElementById("vehicle-info");if(t.length<4)return n.textContent="",n.className="kenteken-status",s.style.display="none",!1;try{n.textContent="⏳ Kenteken controleren...",n.className="kenteken-status checking";const i=await fetch(`https://opendata.rdw.nl/resource/m9d7-ebf2.json?kenteken=${t}`,{headers:{Accept:"application/json"}});if(!i.ok)throw new Error("API request failed");const o=await i.json();if(o&&o.length>0){if(a=o[0],n.textContent="✓ Kenteken gevonden in RDW",n.className="kenteken-status valid",document.getElementById("merk").textContent=a.merk||"Onbekend",document.getElementById("handelsbenaming").textContent=a.handelsbenaming||"Onbekend",a.datum_eerste_toelating){const r=a.datum_eerste_toelating,g=`${r.substring(6,8)}-${r.substring(4,6)}-${r.substring(0,4)}`;document.getElementById("datum_eerste_toelating").textContent=g}else document.getElementById("datum_eerste_toelating").textContent="Onbekend";return s.style.display="block",!0}else return n.textContent="✗ Kenteken niet gevonden in RDW database",n.className="kenteken-status invalid",s.style.display="none",a=null,!1}catch(i){return console.error("Error validating kenteken:",i),n.textContent="⚠ Fout bij het controleren van kenteken",n.className="kenteken-status error",s.style.display="none",!1}}function I(e,t){let n;return function(...i){const o=()=>{clearTimeout(n),e(...i)};clearTimeout(n),n=setTimeout(o,t)}}async function M(e){if(typeof emailjs>"u")throw new Error("EmailJS library not loaded");const t={name:e.naam,subject:e.onderwerp,email:e.email,phone:e.telefoon,license:e.kenteken,message:e.bericht};try{return{success:!0,response:await emailjs.send(b,k,t,P)}}catch(n){throw console.error("EmailJS Error:",n),n}}async function C(e){try{const t={id:Date.now().toString(),name:e.naam,email:e.email,phone:e.telefoon,kenteken:e.kenteken,subject:e.onderwerp,message:e.bericht,vehicleInfo:a?JSON.stringify(a):null,read:!1};try{const n=window.location.hostname==="m3hmet072.github.io"||window.location.hostname==="autoservicehoute.nl"?"https://autoservicehoute-production.up.railway.app/api":"http://localhost:3001/api";console.log("Attempting to save email to:",`${n}/emails`);const s=await fetch(`${n}/emails`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(console.log("API Response status:",s.status),!s.ok){const o=await s.text();throw console.error("API Error response:",o),new Error("API request failed")}const i=await s.json();console.log("Form data saved to database via API:",i)}catch(n){console.error("API save failed, falling back to localStorage:",n);const s=localStorage.getItem("ash_emails"),i=s?JSON.parse(s):[];i.unshift(t),localStorage.setItem("ash_emails",JSON.stringify(i)),console.log("Form data saved to localStorage (fallback)")}}catch(t){console.error("Error saving to dashboard:",t)}}function G(){const e=document.getElementById("contact-form"),t=document.getElementById("kenteken"),n=document.getElementById("submit-btn");if(!e||!t)return;const s=I(async i=>{await h(i)},500);t.addEventListener("input",i=>{s(i.target.value)}),e.addEventListener("submit",async i=>{i.preventDefault();const o=new FormData(e),r=Object.fromEntries(o.entries());if(!await h(r.kenteken)){u("Het ingevoerde kenteken is niet gevonden in de RDW database. Controleer het kenteken en probeer opnieuw.","error");return}n.disabled=!0,n.textContent="Verzenden...";try{if((await M(r)).success)await C(r),u("Uw bericht is succesvol verzonden! We nemen zo spoedig mogelijk contact met u op.","success"),e.reset(),a=null,document.getElementById("kenteken-status").textContent="",document.getElementById("vehicle-info").style.display="none";else throw new Error("Failed to send email")}catch(S){console.error("Error sending email:",S),u("Er is een fout opgetreden bij het verzenden van uw bericht. Probeer het later opnieuw of neem telefonisch contact met ons op.","error")}finally{n.disabled=!1,n.textContent="Versturen"}})}let l=null,c=0,m=0,d=null;function L(e="live-visitor-counter"){const t=document.getElementById(e);if(!t){console.warn("Live visitor counter container not found");return}t.innerHTML=`
    <div class="live-counter">
      <div class="live-indicator">
        <span class="pulse-dot"></span>
        <span class="live-text">Live</span>
      </div>
      <div class="visitor-count">
        <span class="count-number" id="visitor-count">0</span>
        <span class="count-label">mensen bekijken nu</span>
      </div>
    </div>
  `,f(),document.addEventListener("visibilitychange",()=>{document.visibilityState==="visible"&&(!l||l.readyState===EventSource.CLOSED)&&f()})}function f(){const e=window.location.hostname==="localhost"?"http://localhost:3001/api":"https://autoservicehoute-production.up.railway.app/api";try{l=new EventSource(`${e}/visitors/stream`),l.onmessage=t=>{const n=JSON.parse(t.data);A(n.activeVisitors)},l.onerror=t=>{console.error("SSE connection error:",t),l.close(),setTimeout(()=>{document.visibilityState==="visible"&&f()},5e3)},l.onopen=()=>{console.log("✓ Real-time visitor counter connected")}}catch(t){console.error("Failed to connect to visitor stream:",t)}}function A(e){m=e,d&&cancelAnimationFrame(d),w()}function w(){const e=document.getElementById("visitor-count");if(!e)return;const t=m-c;if(Math.abs(t)<.1){c=m,e.textContent=Math.round(c);return}c+=t*.15,e.textContent=Math.round(c),d=requestAnimationFrame(w)}window.addEventListener("beforeunload",()=>{l&&l.close(),d&&cancelAnimationFrame(d)});function O(){const e=navigator.userAgent;let t="Desktop",n="Unknown",s="Unknown",i="Unknown";if(e.includes("Windows NT 10.0"))i="Windows 10";else if(e.includes("Windows NT 6.3"))i="Windows 8.1";else if(e.includes("Mac OS X")){const o=e.match(/Mac OS X ([\d_]+)/);i=o?`macOS ${o[1].replace(/_/g,".")}`:"macOS"}else if(e.includes("Android")){const o=e.match(/Android ([\d.]+)/);i=o?`Android ${o[1]}`:"Android"}else if(e.includes("iPhone")||e.includes("iPad")){const o=e.match(/OS ([\d_]+)/);i=o?`iOS ${o[1].replace(/_/g,".")}`:"iOS"}else e.includes("Linux")&&(i="Linux");return e.includes("Chrome")&&!e.includes("Edg")?s="Chrome":e.includes("Safari")&&!e.includes("Chrome")?s="Safari":e.includes("Firefox")?s="Firefox":e.includes("Edg")?s="Edge":(e.includes("Opera")||e.includes("OPR"))&&(s="Opera"),e.includes("iPhone")?(t="Mobile",e.includes("iPhone15")?n="iPhone 15":e.includes("iPhone14")?n="iPhone 14":e.includes("iPhone13")?n="iPhone 13":e.includes("iPhone12")?n="iPhone 12":e.includes("iPhone11")?n="iPhone 11":e.includes("iPhone X")?n="iPhone X":n="iPhone"):e.includes("iPad")?(t="Tablet",n="iPad",e.includes("iPad Pro")?n="iPad Pro":e.includes("iPad Air")?n="iPad Air":e.includes("iPad Mini")&&(n="iPad Mini")):e.includes("Android")?(t=e.includes("Mobile")?"Mobile":"Tablet",e.includes("SM-S928")?n="Samsung Galaxy S24 Ultra":e.includes("SM-S926")?n="Samsung Galaxy S24+":e.includes("SM-S921")?n="Samsung Galaxy S24":e.includes("SM-S918")?n="Samsung Galaxy S23 Ultra":e.includes("SM-S916")?n="Samsung Galaxy S23+":e.includes("SM-S911")?n="Samsung Galaxy S23":e.includes("SM-S908")?n="Samsung Galaxy S22 Ultra":e.includes("SM-S906")?n="Samsung Galaxy S22+":e.includes("SM-S901")?n="Samsung Galaxy S22":e.includes("SM-G988")?n="Samsung Galaxy S20 Ultra":e.includes("SM-G986")?n="Samsung Galaxy S20+":e.includes("SM-G985")?n="Samsung Galaxy S20+ 5G":e.includes("SM-G981")?n="Samsung Galaxy S20 5G":e.includes("SM-G980")?n="Samsung Galaxy S20":e.includes("SM-G998")?n="Samsung Galaxy S21 Ultra":e.includes("SM-G996")?n="Samsung Galaxy S21+":e.includes("SM-G991")?n="Samsung Galaxy S21":e.includes("SM-N986")?n="Samsung Galaxy Note 20 Ultra":e.includes("SM-N981")?n="Samsung Galaxy Note 20":e.includes("SM-A")?n="Samsung Galaxy A-serie":e.includes("SM-")?n="Samsung Galaxy":e.includes("Pixel 8 Pro")?n="Google Pixel 8 Pro":e.includes("Pixel 8")?n="Google Pixel 8":e.includes("Pixel 7 Pro")?n="Google Pixel 7 Pro":e.includes("Pixel 7")?n="Google Pixel 7":e.includes("Pixel 6 Pro")?n="Google Pixel 6 Pro":e.includes("Pixel 6")?n="Google Pixel 6":e.includes("Pixel")?n="Google Pixel":e.includes("OnePlus")?n="OnePlus":e.includes("Xiaomi")?n="Xiaomi":e.includes("Huawei")?n="Huawei":e.includes("OPPO")?n="OPPO":e.includes("Realme")?n="Realme":n="Android Toestel"):(t="Desktop",e.includes("Windows")?n="Windows PC":e.includes("Mac")?n="Mac":e.includes("Linux")?n="Linux PC":n="Desktop Computer"),{deviceType:t,deviceName:n,browser:s,os:i,screenResolution:`${window.screen.width}x${window.screen.height}`,viewport:`${window.innerWidth}x${window.innerHeight}`}}async function p(){try{const e=O();let t=sessionStorage.getItem("visitorSessionId");if(t&&(await v()||(console.log("Session expired, creating new session"),t=null)),!t){const s=await x(e);s.sessionId&&sessionStorage.setItem("visitorSessionId",s.sessionId)}const n=setInterval(()=>{v().catch(console.error)},3e4);window.addEventListener("beforeunload",()=>{clearInterval(n)})}catch(e){console.error("Failed to initialize visitor tracking:",e)}}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",p):p();y();G();L();
