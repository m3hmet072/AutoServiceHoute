import"./base-D7JJuB-E.js";import{f as M,a as j,b as R,c as z,d as P,e as q,g as T,h as A,u as C,i as _,j as V}from"./api-BnFKTpth.js";import"./auth-C_FCBoUG.js";const W="modulepreload",O=function(l){return"/"+l},L={},F=function(t,a,e){let n=Promise.resolve();if(a&&a.length>0){let r=function(d){return Promise.all(d.map(u=>Promise.resolve(u).then(c=>({status:"fulfilled",value:c}),c=>({status:"rejected",reason:c}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),s=o?.nonce||o?.getAttribute("nonce");n=r(a.map(d=>{if(d=O(d),d in L)return;L[d]=!0;const u=d.endsWith(".css"),c=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${c}`))return;const p=document.createElement("link");if(p.rel=u?"stylesheet":W,u||(p.as="script"),p.crossOrigin="",p.href=d,s&&p.setAttribute("nonce",s),document.head.appendChild(p),u)return new Promise((m,g)=>{p.addEventListener("load",m),p.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${d}`)))})}))}function i(o){const s=new Event("vite:preloadError",{cancelable:!0});if(s.payload=o,window.dispatchEvent(s),!s.defaultPrevented)throw o}return n.then(o=>{for(const s of o||[])s.status==="rejected"&&i(s.reason);return t().catch(i)})},H={en:{dashboard:"Dashboard",calendar:"Calendar",appointments:"Appointments",emails:"E-mails",settings:"Settings",admin:"Admin",owner:"Owner",totalAppointments:"Total Appointments",allAppointments:"All appointments",completed:"Completed",completedAppointments:"Completed appointments",emailsReceived:"E-mails Received",allEmails:"All e-mails",unreadEmails:"Unread E-mails",yetToRead:"Yet to read",appointmentsToday:"Appointments Today",noAppointmentsToday:"No appointments for today",recentEmails:"Recent E-mails",noNewEmails:"No new e-mails",month:"Month",week:"Week",today:"Today",all:"All",newRequest:"New Request",confirmed:"Confirmed",inProgress:"In Progress",addAppointment:"Add Appointment",noAppointments:"No appointments",inbox:"Inbox",unread:"Unread",read:"Read",markAsRead:"Mark as read",reply:"Reply",delete:"Delete",accountInformation:"Account Information",businessName:"Business Name",email:"Email",phone:"Phone",address:"Address",saveChanges:"Save Changes",openingHours:"Opening Hours",monday:"Monday",tuesday:"Tuesday",wednesday:"Wednesday",thursday:"Thursday",friday:"Friday",saturday:"Saturday",sunday:"Sunday",closed:"Closed",notifications:"Notifications",emailNotifications:"Email Notifications",receiveEmailNotifications:"Receive email notifications for new appointments",pushNotifications:"Push Notifications",receivePushNotifications:"Receive push notifications",dataManagement:"Data Management",exportData:"Export Data",exportDataDesc:"Export all your data as JSON file",export:"Export",importData:"Import Data",importDataDesc:"Import data from JSON file",import:"Import",clearAllData:"Clear All Data",clearAllDataDesc:"This will delete all appointments and emails",clearData:"Clear Data",language:"Language",selectLanguage:"Select Language",from:"From",to:"To",january:"January",february:"February",march:"March",april:"April",may:"May",june:"June",july:"July",august:"August",september:"September",october:"October",november:"November",december:"December",websiteInfo:"Website Info",websiteInfoDesc:"View statistics about visitors on your website",activeNow:"Active Now",liveVisitors:"Live visitors",today:"Today",uniqueVisitorsToday:"Unique visitors today",yesterday:"Yesterday",uniqueVisitorsYesterday:"Unique visitors yesterday",totalVisitors:"Total Visitors",allTime:"All time",totalSessions:"Total Sessions",allSessions:"All sessions",averageDuration:"Average Duration",perSession:"Per session",visitorTrends:"Visitor Trends",newTestEmailAdded:"New test e-mail added!",appointmentAlreadyExists:"An appointment already exists for this message",appointmentCreated:"Appointment created! Email moved to appointments.",appointmentScheduledToday:"Appointment scheduled for today at {time}. Email moved to appointments.",appointmentScheduledTomorrow:"Appointment scheduled for tomorrow at {time}. Email moved to appointments.",requestRejectedDeleted:"Request rejected and deleted",statusUpdated:"Status updated to: {status}",fillAllFields:"Please fill in all required fields",appointmentUpdated:"Appointment successfully updated",appointmentDeleted:"Appointment deleted",emailDeleted:"E-mail deleted",workDaysAdded:"{count} work days added to calendar!",allDataCleared:"All data cleared",clearAllDataConfirm:"Are you sure you want to delete all data? This cannot be undone!",statusNew:"New Request",statusConfirmed:"Confirmed",statusInProgress:"In Progress",statusCompleted:"Completed",appointmentDetails:"Appointment Details",emailDetails:"E-mail Details",name:"Name",date:"Date",time:"Time",licensePlate:"License Plate",service:"Service",notes:"Notes",message:"Message",edit:"Edit",save:"Save",cancel:"Cancel",close:"Close",confirm:"Confirm",reject:"Reject",schedule:"Schedule",acceptScheduleToday:"Accept & Schedule Today",chooseDate:"Choose Date",deleteConfirm:"Are you sure you want to delete this?",deleteAppointmentConfirm:"Are you sure you want to delete this appointment?",deleteEmailConfirm:"Are you sure you want to delete this e-mail?",yes:"Yes",no:"No",confirmation:"Confirmation",yesContinue:"Yes, continue",requestFrom:"Request from",receivedOn:"Received on",viewDetails:"View details",importCalendar:"Import Calendar",selectICSFile:"Select ICS File",importWorkDays:"Import Work Days",addNewAppointment:"Add New Appointment",viewAllEmails:"View All E-mails",exportReport:"Export Report",sun:"Sun",mon:"Mon",tue:"Tue",wed:"Wed",thu:"Thu",fri:"Fri",sat:"Sat",allDates:"All Dates",tomorrow:"Tomorrow",thisWeek:"This Week",nextWeek:"Next Week",allTimes:"All Times",morning:"Morning",afternoon:"Afternoon",activeAppointments:"Active Appointments",newRequests:"New Requests",completedAppointments2:"Completed Appointments",monday:"Monday",tuesday:"Tuesday",wednesday:"Wednesday",thursday:"Thursday",friday:"Friday",saturday:"Saturday",sunday:"Sunday",garageInfo:"Garage Information",companyName:"Company Name",emailAddress:"Email Address",phoneNumber:"Phone Number",openingHours:"Opening Hours",dataManagement:"Data Management",importWorkSchedule:"Import Work Schedule",uploadICSDescription:"Upload an iCalendar (.ics) file to add work days to the calendar",importCalendarFile:"Import Calendar",deleteAllData:"Delete All Data",warningCannotUndo:"Warning: This action cannot be undone.",addTestEmail:"Add Test Email",addManualEmail:"Add Manual Entry",manualEntryTitle:"Enter New Customer Information",manualEntryDesc:"Fill in the details below when a customer calls or contacts you",customerName:"Name",customerEmail:"Email",customerPhone:"Phone Number",serviceType:"Service Type",customerMessage:"Message/Note",contactMethod:"Contact Method",preferredDate:"Preferred Date",preferredTime:"Preferred Time",cancel:"Cancel",saveToList:"Save to List",emailAddedSuccess:"Contact successfully added to the list!",noEmailsReceived:"No emails received",recentEmailsTitle:"Recent Emails",noNewEmailsReceived:"No new emails",appointmentsOn:"Appointments on",more:"more",receivedOn:"Received on",subject:"Subject",status:"Status",actions:"Actions",search:"Search",filter:"Filter",sortBy:"Sort by",noResults:"No results found",loading:"Loading..."},tr:{dashboard:"GÃ¶sterge Paneli",calendar:"Takvim",appointments:"Randevular",emails:"E-postalar",settings:"Ayarlar",admin:"YÃ¶netici",owner:"Sahip",totalAppointments:"Toplam Randevular",allAppointments:"TÃ¼m randevular",completed:"TamamlandÄ±",completedAppointments:"Tamamlanan randevular",emailsReceived:"AlÄ±nan E-postalar",allEmails:"TÃ¼m e-postalar",unreadEmails:"OkunmamÄ±ÅŸ E-postalar",yetToRead:"HenÃ¼z okunmadÄ±",appointmentsToday:"BugÃ¼nkÃ¼ Randevular",noAppointmentsToday:"BugÃ¼n randevu yok",recentEmails:"Son E-postalar",noNewEmails:"Yeni e-posta yok",month:"Ay",week:"Hafta",today:"BugÃ¼n",all:"Hepsi",newRequest:"Yeni Talep",confirmed:"OnaylandÄ±",inProgress:"Ä°ÅŸlemde",addAppointment:"Randevu Ekle",noAppointments:"Randevu yok",inbox:"Gelen Kutusu",unread:"OkunmamÄ±ÅŸ",read:"Okundu",markAsRead:"Okundu olarak iÅŸaretle",reply:"YanÄ±tla",delete:"Sil",accountInformation:"Hesap Bilgileri",businessName:"Ä°ÅŸletme AdÄ±",email:"E-posta",phone:"Telefon",address:"Adres",saveChanges:"DeÄŸiÅŸiklikleri Kaydet",openingHours:"Ã‡alÄ±ÅŸma Saatleri",monday:"Pazartesi",tuesday:"SalÄ±",wednesday:"Ã‡arÅŸamba",thursday:"PerÅŸembe",friday:"Cuma",saturday:"Cumartesi",sunday:"Pazar",closed:"KapalÄ±",notifications:"Bildirimler",emailNotifications:"E-posta Bildirimleri",receiveEmailNotifications:"Yeni randevular iÃ§in e-posta bildirimleri al",pushNotifications:"AnlÄ±k Bildirimler",receivePushNotifications:"AnlÄ±k bildirimler al",dataManagement:"Veri YÃ¶netimi",exportData:"Veriyi DÄ±ÅŸa Aktar",exportDataDesc:"TÃ¼m verilerinizi JSON dosyasÄ± olarak dÄ±ÅŸa aktarÄ±n",export:"DÄ±ÅŸa Aktar",importData:"Veri Ä°Ã§e Aktar",importDataDesc:"JSON dosyasÄ±ndan veri iÃ§e aktarÄ±n",import:"Ä°Ã§e Aktar",clearAllData:"TÃ¼m Verileri Temizle",clearAllDataDesc:"Bu iÅŸlem tÃ¼m randevularÄ± ve e-postalarÄ± silecektir",clearData:"Verileri Temizle",language:"Dil",selectLanguage:"Dil SeÃ§in",from:"BaÅŸlangÄ±Ã§",to:"BitiÅŸ",january:"Ocak",february:"Åubat",march:"Mart",april:"Nisan",may:"MayÄ±s",june:"Haziran",july:"Temmuz",august:"AÄŸustos",september:"EylÃ¼l",october:"Ekim",november:"KasÄ±m",december:"AralÄ±k",websiteInfo:"Website Bilgisi",websiteInfoDesc:"Web sitenize gelen ziyaretÃ§iler hakkÄ±nda istatistikleri gÃ¶rÃ¼ntÃ¼leyin",activeNow:"Åu Anda Aktif",liveVisitors:"CanlÄ± ziyaretÃ§iler",today:"BugÃ¼n",uniqueVisitorsToday:"BugÃ¼nÃ¼n benzersiz ziyaretÃ§ileri",yesterday:"DÃ¼n",uniqueVisitorsYesterday:"DÃ¼nÃ¼n benzersiz ziyaretÃ§ileri",totalVisitors:"Toplam ZiyaretÃ§iler",allTime:"TÃ¼m zamanlar",totalSessions:"Toplam Oturumlar",allSessions:"TÃ¼m oturumlar",averageDuration:"Ortalama SÃ¼re",perSession:"Oturum baÅŸÄ±na",visitorTrends:"ZiyaretÃ§i Trendleri",newTestEmailAdded:"Yeni test e-postasÄ± eklendi!",appointmentAlreadyExists:"Bu mesaj iÃ§in zaten bir randevu var",appointmentCreated:"Randevu oluÅŸturuldu! E-posta randevulara taÅŸÄ±ndÄ±.",appointmentScheduledToday:"Randevu bugÃ¼n saat {time} iÃ§in planlandÄ±. E-posta randevulara taÅŸÄ±ndÄ±.",appointmentScheduledTomorrow:"Randevu yarÄ±n saat {time} iÃ§in planlandÄ±. E-posta randevulara taÅŸÄ±ndÄ±.",requestRejectedDeleted:"Talep reddedildi ve silindi",statusUpdated:"Durum gÃ¼ncellendi: {status}",fillAllFields:"LÃ¼tfen tÃ¼m gerekli alanlarÄ± doldurun",appointmentUpdated:"Randevu baÅŸarÄ±yla gÃ¼ncellendi",appointmentDeleted:"Randevu silindi",emailDeleted:"E-posta silindi",workDaysAdded:"{count} Ã§alÄ±ÅŸma gÃ¼nÃ¼ takvime eklendi!",allDataCleared:"TÃ¼m veriler temizlendi",clearAllDataConfirm:"TÃ¼m verileri silmek istediÄŸinizden emin misiniz? Bu iÅŸlem geri alÄ±namaz!",statusNew:"Yeni Talep",statusConfirmed:"OnaylandÄ±",statusInProgress:"Ä°ÅŸlemde",statusCompleted:"TamamlandÄ±",appointmentDetails:"Randevu DetaylarÄ±",emailDetails:"E-posta DetaylarÄ±",name:"Ad",date:"Tarih",time:"Saat",licensePlate:"Plaka",service:"Hizmet",notes:"Notlar",message:"Mesaj",edit:"DÃ¼zenle",save:"Kaydet",cancel:"Ä°ptal",close:"Kapat",confirm:"Onayla",reject:"Reddet",schedule:"Planla",acceptScheduleToday:"Kabul Et & BugÃ¼n Planla",chooseDate:"Tarih SeÃ§",deleteConfirm:"Bunu silmek istediÄŸinizden emin misiniz?",deleteAppointmentConfirm:"Bu randevuyu silmek istediÄŸinizden emin misiniz?",deleteEmailConfirm:"Bu e-postayÄ± silmek istediÄŸinizden emin misiniz?",yes:"Evet",no:"HayÄ±r",confirmation:"Onay",yesContinue:"Evet, devam et",requestFrom:"Talep",receivedOn:"AlÄ±ndÄ±",viewDetails:"DetaylarÄ± gÃ¶rÃ¼ntÃ¼le",importCalendar:"Takvim Ä°Ã§e Aktar",selectICSFile:"ICS DosyasÄ± SeÃ§",importWorkDays:"Ã‡alÄ±ÅŸma GÃ¼nlerini Ä°Ã§e Aktar",addNewAppointment:"Yeni Randevu Ekle",viewAllEmails:"TÃ¼m E-postalarÄ± GÃ¶rÃ¼ntÃ¼le",exportReport:"Rapor DÄ±ÅŸa Aktar",sun:"Paz",mon:"Pzt",tue:"Sal",wed:"Ã‡ar",thu:"Per",fri:"Cum",sat:"Cmt",allDates:"TÃ¼m Tarihler",tomorrow:"YarÄ±n",thisWeek:"Bu Hafta",nextWeek:"Gelecek Hafta",allTimes:"TÃ¼m Saatler",morning:"Sabah",afternoon:"Ã–ÄŸleden Sonra",activeAppointments:"Aktif Randevular",newRequests:"Yeni Talepler",completedAppointments2:"Tamamlanan Randevular",monday:"Pazartesi",tuesday:"SalÄ±",wednesday:"Ã‡arÅŸamba",thursday:"PerÅŸembe",friday:"Cuma",saturday:"Cumartesi",sunday:"Pazar",garageInfo:"Garaj Bilgileri",companyName:"Åirket AdÄ±",emailAddress:"E-posta Adresi",phoneNumber:"Telefon NumarasÄ±",openingHours:"AÃ§Ä±lÄ±ÅŸ Saatleri",dataManagement:"Veri YÃ¶netimi",importWorkSchedule:"Ã‡alÄ±ÅŸma Takvimini Ä°Ã§e Aktar",uploadICSDescription:"Ã‡alÄ±ÅŸma gÃ¼nlerini takvime eklemek iÃ§in bir iCalendar (.ics) dosyasÄ± yÃ¼kleyin",importCalendarFile:"Takvim Ä°Ã§e Aktar",deleteAllData:"TÃ¼m Verileri Sil",warningCannotUndo:"UyarÄ±: Bu iÅŸlem geri alÄ±namaz.",addTestEmail:"Test E-postasÄ± Ekle",addManualEmail:"Manuel GiriÅŸ Ekle",manualEntryTitle:"Yeni MÃ¼ÅŸteri Bilgileri Girin",manualEntryDesc:"Bir mÃ¼ÅŸteri aradÄ±ÄŸÄ±nda veya iletiÅŸim kurduÄŸunda aÅŸaÄŸÄ±daki bilgileri doldurun",customerName:"Ad",customerEmail:"E-posta",customerPhone:"Telefon NumarasÄ±",serviceType:"Hizmet TÃ¼rÃ¼",customerMessage:"Mesaj/Not",contactMethod:"Ä°letiÅŸim YÃ¶ntemi",preferredDate:"Tercih Edilen Tarih",preferredTime:"Tercih Edilen Saat",cancel:"Ä°ptal",saveToList:"Listeye Kaydet",emailAddedSuccess:"KiÅŸi baÅŸarÄ±yla listeye eklendi!",noEmailsReceived:"AlÄ±nan e-posta yok",recentEmailsTitle:"Son E-postalar",noNewEmailsReceived:"Yeni e-posta yok",appointmentsOn:"Randevular",more:"daha fazla",receivedOn:"AlÄ±ndÄ±",subject:"Konu",status:"Durum",actions:"Ä°ÅŸlemler",search:"Ara",filter:"Filtrele",sortBy:"SÄ±rala",noResults:"SonuÃ§ bulunamadÄ±",loading:"YÃ¼kleniyor..."},nl:{dashboard:"Dashboard",calendar:"Kalender",appointments:"Afspraken",emails:"E-mails",settings:"Instellingen",admin:"Admin",owner:"Eigenaar",totalAppointments:"Totaal Afspraken",allAppointments:"Alle afspraken",completed:"Afgerond",completedAppointments:"Voltooide afspraken",emailsReceived:"E-mails Ontvangen",allEmails:"Alle e-mails",unreadEmails:"Ongelezen E-mails",yetToRead:"Nog te lezen",appointmentsToday:"Afspraken Vandaag",noAppointmentsToday:"Geen afspraken voor vandaag",recentEmails:"Recente E-mails",noNewEmails:"Geen nieuwe e-mails",month:"Maand",week:"Week",today:"Vandaag",all:"Alles",newRequest:"Nieuwe Aanvraag",confirmed:"Bevestigd",inProgress:"In Behandeling",addAppointment:"Afspraak Toevoegen",noAppointments:"Geen afspraken",inbox:"Inbox",unread:"Ongelezen",read:"Gelezen",markAsRead:"Markeer als gelezen",reply:"Beantwoorden",delete:"Verwijderen",accountInformation:"Accountinformatie",businessName:"Bedrijfsnaam",email:"E-mail",phone:"Telefoon",address:"Adres",saveChanges:"Wijzigingen Opslaan",openingHours:"Openingstijden",monday:"Maandag",tuesday:"Dinsdag",wednesday:"Woensdag",thursday:"Donderdag",friday:"Vrijdag",saturday:"Zaterdag",sunday:"Zondag",closed:"Gesloten",notifications:"Meldingen",emailNotifications:"E-mailmeldingen",receiveEmailNotifications:"Ontvang e-mailmeldingen voor nieuwe afspraken",pushNotifications:"Pushmeldingen",receivePushNotifications:"Ontvang pushmeldingen",dataManagement:"Gegevensbeheer",exportData:"Gegevens Exporteren",exportDataDesc:"Exporteer al uw gegevens als JSON-bestand",export:"Exporteren",importData:"Gegevens Importeren",importDataDesc:"Importeer gegevens uit JSON-bestand",import:"Importeren",clearAllData:"Alle Gegevens Wissen",clearAllDataDesc:"Dit zal alle afspraken en e-mails verwijderen",clearData:"Gegevens Wissen",language:"Taal",selectLanguage:"Selecteer Taal",from:"Van",to:"Tot",january:"Januari",february:"Februari",march:"Maart",april:"April",may:"Mei",june:"Juni",july:"Juli",august:"Augustus",september:"September",october:"Oktober",november:"November",december:"December",websiteInfo:"Website Info",websiteInfoDesc:"Bekijk statistieken over bezoekers op uw website",activeNow:"Nu Actief",liveVisitors:"Live bezoekers",today:"Vandaag",uniqueVisitorsToday:"Unieke bezoekers vandaag",yesterday:"Gisteren",uniqueVisitorsYesterday:"Unieke bezoekers gisteren",totalVisitors:"Totaal Bezoekers",allTime:"Alle tijd",totalSessions:"Totaal Sessies",allSessions:"Alle sessies",averageDuration:"Gemiddelde Duur",perSession:"Per sessie",visitorTrends:"Bezoeker Trends",newTestEmailAdded:"Nieuwe test e-mail toegevoegd!",appointmentAlreadyExists:"Er bestaat al een afspraak voor dit bericht",appointmentCreated:"Afspraak aangemaakt! Email verplaatst naar afspraken.",appointmentScheduledToday:"Afspraak gepland voor vandaag om {time}. Email verplaatst naar afspraken.",appointmentScheduledTomorrow:"Afspraak gepland voor morgen om {time}. Email verplaatst naar afspraken.",requestRejectedDeleted:"Aanvraag afgewezen en verwijderd",statusUpdated:"Status bijgewerkt naar: {status}",fillAllFields:"Vul alle verplichte velden in",appointmentUpdated:"Afspraak succesvol bijgewerkt",appointmentDeleted:"Afspraak verwijderd",emailDeleted:"E-mail verwijderd",workDaysAdded:"{count} werkdagen toegevoegd aan kalender!",allDataCleared:"Alle data verwijderd",clearAllDataConfirm:"Weet je zeker dat je alle data wilt verwijderen? Dit kan niet ongedaan worden gemaakt!",statusNew:"Nieuwe Aanvraag",statusConfirmed:"Bevestigd",statusInProgress:"In Behandeling",statusCompleted:"Afgerond",appointmentDetails:"Afspraak Details",emailDetails:"E-mail Details",name:"Naam",date:"Datum",time:"Tijd",licensePlate:"Kenteken",service:"Dienst",notes:"Opmerkingen",message:"Bericht",edit:"Bewerken",save:"Opslaan",cancel:"Annuleren",close:"Sluiten",confirm:"Bevestigen",reject:"Afwijzen",schedule:"Inplannen",acceptScheduleToday:"Accepteren & Plan Vandaag",chooseDate:"Datum Kiezen",deleteConfirm:"Weet je zeker dat je dit wilt verwijderen?",deleteAppointmentConfirm:"Weet je zeker dat je deze afspraak wilt verwijderen?",deleteEmailConfirm:"Weet je zeker dat je deze e-mail wilt verwijderen?",yes:"Ja",no:"Nee",confirmation:"Bevestiging",yesContinue:"Ja, doorgaan",requestFrom:"Aanvraag van",receivedOn:"Ontvangen op",viewDetails:"Bekijk details",importCalendar:"Kalender Importeren",selectICSFile:"Selecteer ICS Bestand",importWorkDays:"Werkdagen Importeren",addNewAppointment:"Nieuwe Afspraak Toevoegen",viewAllEmails:"Alle E-mails Bekijken",exportReport:"Rapport Exporteren",sun:"Zo",mon:"Ma",tue:"Di",wed:"Wo",thu:"Do",fri:"Vr",sat:"Za",allDates:"Alle Data",tomorrow:"Morgen",thisWeek:"Deze Week",nextWeek:"Volgende Week",allTimes:"Alle Tijden",morning:"Ochtend",afternoon:"Middag",activeAppointments:"Actieve Afspraken",newRequests:"Nieuwe Aanvragen",completedAppointments2:"Afgeronde Afspraken",monday:"Maandag",tuesday:"Dinsdag",wednesday:"Woensdag",thursday:"Donderdag",friday:"Vrijdag",saturday:"Zaterdag",sunday:"Zondag",garageInfo:"Garage Informatie",companyName:"Bedrijfsnaam",emailAddress:"E-mailadres",phoneNumber:"Telefoonnummer",openingHours:"Openingstijden",dataManagement:"Data Beheer",importWorkSchedule:"Werkrooster Importeren",uploadICSDescription:"Upload een iCalendar (.ics) bestand om werkdagen toe te voegen aan de kalender",importCalendarFile:"Kalender Importeren",deleteAllData:"Alle Data Verwijderen",warningCannotUndo:"Let op: Deze actie kan niet ongedaan worden gemaakt.",addTestEmail:"Test E-mail Toevoegen",addManualEmail:"Handmatige Invoer Toevoegen",manualEntryTitle:"Nieuwe Klantgegevens Invoeren",manualEntryDesc:"Vul onderstaande gegevens in wanneer een klant belt of contact opneemt",customerName:"Naam",customerEmail:"E-mail",customerPhone:"Telefoonnummer",serviceType:"Service Type",customerMessage:"Bericht/Opmerking",contactMethod:"Contactmethode",preferredDate:"Gewenste Datum",preferredTime:"Gewenste Tijd",cancel:"Annuleren",saveToList:"Opslaan in Lijst",emailAddedSuccess:"Contact succesvol toegevoegd aan de lijst!",noEmailsReceived:"Geen e-mails ontvangen",recentEmailsTitle:"Recent E-mails",noNewEmailsReceived:"Geen nieuwe e-mails",appointmentsOn:"Afspraken op",more:"meer",receivedOn:"Ontvangen op",subject:"Onderwerp",status:"Status",actions:"Acties",search:"Zoeken",filter:"Filter",sortBy:"Sorteer op",noResults:"Geen resultaten gevonden",loading:"Laden..."}},I="https://opendata.rdw.nl/resource";function N(l){return l.toUpperCase().replace(/[-\s]/g,"")}function B(l){const t=l.toUpperCase().replace(/[-\s]/g,"");return t.length===6?`${t.slice(0,2)}-${t.slice(2,4)}-${t.slice(4,6)}`:t}async function K(l){const t=N(l);if(t.length<4)throw new Error("Kenteken moet minimaal 4 tekens bevatten");try{const a=await fetch(`${I}/m9d7-ebf2.json?kenteken=${t}`,{headers:{Accept:"application/json"}});if(!a.ok)throw new Error("Kenteken niet gevonden in RDW database");const e=await a.json();if(!e||e.length===0)throw new Error("Kenteken niet gevonden");const n=e[0];return{kenteken:t,merk:n.merk||"-",handelsbenaming:n.handelsbenaming||"-",voertuigsoort:n.voertuigsoort||"-",inrichting:n.inrichting||"-",aantal_zitplaatsen:n.aantal_zitplaatsen||"-",eerste_kleur:n.eerste_kleur||"-",tweede_kleur:n.tweede_kleur||null,aantal_cilinders:n.aantal_cilinders||"-",cilinderinhoud:n.cilinderinhoud||"-",massa_ledig_voertuig:n.massa_ledig_voertuig||"-",datum_eerste_toelating:n.datum_eerste_toelating||"-",datum_tenaamstelling:n.datum_tenaamstelling||"-",brandstof_omschrijving:n.brandstof_omschrijving||"-",catalogusprijs:n.catalogusprijs||"-",wacht_op_keuren:n.wacht_op_keuren||"Nee",vervaldatum_apk:n.vervaldatum_apk||"-",taxi_indicator:n.taxi_indicator||"Nee",maximum_massa_samenstelling:n.maximum_massa_samenstelling||"-",type:n.type||"-",typegoedkeuringsnummer:n.typegoedkeuringsnummer||"-",variant:n.variant||"-",uitvoering:n.uitvoering||"-",volgnummer_wijziging_eu_typegoedkeuring:n.volgnummer_wijziging_eu_typegoedkeuring||"-",vermogen_massarijklaar:n.vermogen_massarijklaar||"-",wielbasis:n.wielbasis||"-",export_indicator:n.export_indicator||"Nee"}}catch(a){throw console.error("RDW API Error:",a),a}}async function G(l){const t=N(l);try{const a=await fetch(`${I}/a34c-vvps.json?kenteken=${t}`,{headers:{Accept:"application/json"}});if(!a.ok)return null;const e=await a.json();return!e||e.length===0?null:e[0]}catch(a){return console.error("APK API Error:",a),null}}function U(l){if(!l)return!1;let t,a,e;if(l.length===8&&!l.includes("-"))t=parseInt(l.substring(0,4)),a=parseInt(l.substring(4,6)),e=parseInt(l.substring(6,8));else if(l.includes("-"))[t,a,e]=l.split("-").map(Number);else return!1;const n=new Date(t,a-1,e);if(isNaN(n.getTime()))return!1;const i=new Date,o=new Date(i.getTime()+720*60*60*1e3);return n<=o}function S(l){if(!l||l==="-")return"-";try{let t,a,e;if(l.length===8&&!l.includes("-"))t=parseInt(l.substring(0,4)),a=parseInt(l.substring(4,6)),e=parseInt(l.substring(6,8));else if(l.includes("-"))[t,a,e]=l.split("-").map(Number);else return l;const n=new Date(t,a-1,e);return isNaN(n.getTime())?l:n.toLocaleDateString("nl-NL",{day:"numeric",month:"long",year:"numeric"})}catch{return l}}let $=null;async function x(){try{const l=await M();E("active-visitors-count",l.activeVisitors||0),E("today-visitors-count",l.todayVisitors||0),E("yesterday-visitors-count",l.yesterdayVisitors||0),E("total-visitors-count",l.totalVisitors||0),E("total-sessions-count",l.totalSessions||0),E("avg-session-duration",J(l.avgSessionDuration||0))}catch(l){console.error("Failed to fetch visitor stats:",l)}}async function Y(l=30){try{const t=await j(l),a=document.getElementById("visitor-chart");if(!a)return;const e=t.map(o=>new Date(o.date).toLocaleDateString("nl-NL",{month:"short",day:"numeric"})),n=t.map(o=>o.uniqueVisitors),i=t.map(o=>o.totalSessions);if(window.Chart){$&&$.destroy();const o=a.getContext("2d");$=new Chart(o,{type:"line",data:{labels:e,datasets:[{label:"Unique Bezoekers",data:n,borderColor:"rgb(75, 192, 192)",backgroundColor:"rgba(75, 192, 192, 0.2)",tension:.1},{label:"Totaal Sessies",data:i,borderColor:"rgb(255, 99, 132)",backgroundColor:"rgba(255, 99, 132, 0.2)",tension:.1}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top"},title:{display:!0,text:`Bezoekersstatistieken (Laatste ${l} Dagen)`}},scales:{y:{beginAtZero:!0,ticks:{precision:0}}}}})}}catch(t){console.error("Failed to load visitor chart:",t)}}function E(l,t){const a=document.getElementById(l);a&&(a.textContent=t)}function J(l){const t=Math.floor(l/60),a=Math.floor(l%60);return`${t}m ${a}s`}setInterval(x,1e4);x();Y(30);class Z{constructor(){this.currentView="month",this.currentDate=new Date,this.appointments=[],this.emails=[],this.workDays=[],this.currentLanguage=this.loadData("language")||"en",this.translations=H,this.init()}formatDateString(t){const a=t.getFullYear(),e=String(t.getMonth()+1).padStart(2,"0"),n=String(t.getDate()).padStart(2,"0");return`${a}-${e}-${n}`}init(){this.loadAllData().then(()=>{this.setupLanguage(),this.setupNavigation(),this.setupCalendar(),this.setupAppointments(),this.setupEmails(),this.setupSettings(),this.setupModal(),this.updateStats(),this.renderDashboard(),this.renderCalendar(),this.applyTranslations()})}async loadAllData(){try{[this.appointments,this.emails,this.workDays]=await Promise.all([R(),z(),P()]),console.log("âœ“ Data loaded from database")}catch(t){console.error("Error loading data:",t),this.appointments=this.loadData("appointments")||[],this.emails=this.loadData("emails")||[],this.workDays=this.loadData("workDays")||[]}}setupLanguage(){const t=document.getElementById("language-select");if(!t)return;const a=t.querySelector(".select-trigger"),e=t.querySelectorAll(".select-option"),n=t.querySelector(".selected-value"),i={en:{flag:"ğŸ‡¬ğŸ‡§",name:"English"},tr:{flag:"ğŸ‡¹ğŸ‡·",name:"TÃ¼rkÃ§e"},nl:{flag:"ğŸ‡³ğŸ‡±",name:"Nederlands"}},o=i[this.currentLanguage];o&&(n.innerHTML=`
        <span class="flag-icon">${o.flag}</span>
        <span class="lang-text">${o.name}</span>
      `),e.forEach(r=>{r.dataset.value===this.currentLanguage&&r.classList.add("selected")}),a.addEventListener("click",r=>{r.stopPropagation(),t.classList.toggle("open")}),e.forEach(r=>{r.addEventListener("click",d=>{d.stopPropagation();const u=r.dataset.value;e.forEach(p=>p.classList.remove("selected")),r.classList.add("selected");const c=i[u];n.innerHTML=`
          <span class="flag-icon">${c.flag}</span>
          <span class="lang-text">${c.name}</span>
        `,t.classList.remove("open"),this.currentLanguage=u,this.saveData("language",this.currentLanguage),this.applyTranslations(),this.renderDashboard(),this.renderCalendar(),document.getElementById("section-appointments").classList.contains("active")&&this.renderAppointments(),document.getElementById("section-emails").classList.contains("active")&&this.renderEmails()})}),document.addEventListener("click",r=>{t.contains(r.target)||t.classList.remove("open")}),document.addEventListener("keydown",r=>{r.key==="Escape"&&t.classList.contains("open")&&t.classList.remove("open")});const s=document.getElementById("logout-btn");s&&s.addEventListener("click",()=>{confirm("Are you sure you want to logout?")&&F(()=>import("./auth-C_FCBoUG.js"),[]).then(r=>{r.logout()})})}applyTranslations(){const t=this.currentLanguage,a=this.translations[t];a&&(document.querySelectorAll("[data-translate]").forEach(e=>{const n=e.getAttribute("data-translate");a[n]&&(e.textContent=a[n])}),document.documentElement.lang=t)}translate(t,a={}){const e=this.translations[this.currentLanguage];let n=e&&e[t]?e[t]:t;return Object.keys(a).forEach(i=>{n=n.replace(`{${i}}`,a[i])}),n}getLocale(){return{en:"en-US",tr:"tr-TR",nl:"nl-NL"}[this.currentLanguage]||"en-US"}getStatusText(t){const a={"nieuwe-aanvraag":"statusNew",bevestigd:"statusConfirmed","in-behandeling":"statusInProgress",afgerond:"statusCompleted"};return this.translate(a[t]||t)}loadData(t){const a=localStorage.getItem(`ash_${t}`);return a?JSON.parse(a):null}saveData(t,a){localStorage.setItem(`ash_${t}`,JSON.stringify(a))}setupNavigation(){const t=document.querySelectorAll(".nav-item"),a=document.querySelectorAll(".content-section");t.forEach(i=>{i.addEventListener("click",o=>{o.preventDefault();const s=i.dataset.section;t.forEach(r=>r.classList.remove("active")),a.forEach(r=>r.classList.remove("active")),i.classList.add("active"),document.getElementById(`section-${s}`).classList.add("active"),s==="calendar"?this.renderCalendar():s==="appointments"?this.renderAppointments():s==="emails"&&this.renderEmails()})});const e=document.getElementById("mobile-toggle"),n=document.getElementById("sidebar");e&&n&&(e.addEventListener("click",()=>{n.classList.toggle("active")}),document.addEventListener("click",i=>{window.innerWidth<=1024&&!n.contains(i.target)&&!e.contains(i.target)&&n.classList.remove("active")}))}setupCalendar(){const t=document.querySelectorAll(".view-btn"),a=document.getElementById("prev-period"),e=document.getElementById("next-period"),n=document.getElementById("today-btn");t.forEach(i=>{i.addEventListener("click",()=>{t.forEach(o=>o.classList.remove("active")),i.classList.add("active"),this.currentView=i.dataset.view,this.renderCalendar()})}),a.addEventListener("click",()=>{this.currentView==="month"?this.currentDate.setMonth(this.currentDate.getMonth()-1):this.currentDate.setDate(this.currentDate.getDate()-7),this.renderCalendar()}),e.addEventListener("click",()=>{this.currentView==="month"?this.currentDate.setMonth(this.currentDate.getMonth()+1):this.currentDate.setDate(this.currentDate.getDate()+7),this.renderCalendar()}),n.addEventListener("click",()=>{this.currentDate=new Date,this.renderCalendar()})}renderCalendar(){const t=document.getElementById("calendar-view"),a=document.getElementById("current-period");if(this.currentView==="month")this.renderMonthView(t),a.textContent=this.currentDate.toLocaleDateString("nl-NL",{month:"long",year:"numeric"});else{this.renderWeekView(t);const e=this.getWeekStart(this.currentDate),n=new Date(e);n.setDate(n.getDate()+6),a.textContent=`${e.getDate()} - ${n.getDate()} ${e.toLocaleDateString("nl-NL",{month:"long",year:"numeric"})}`}}renderMonthView(t){const a=this.currentDate.getFullYear(),e=this.currentDate.getMonth(),n=new Date(a,e,1),i=new Date(a,e+1,0),o=new Date(a,e,0),s=n.getDay(),r=i.getDate(),d=o.getDate(),u=s===0?6:s-1;let c='<div class="calendar-grid">';[this.translate("mon"),this.translate("tue"),this.translate("wed"),this.translate("thu"),this.translate("fri"),this.translate("sat"),this.translate("sun")].forEach(h=>{c+=`<div class="calendar-header">${h}</div>`});for(let h=u-1;h>=0;h--){const y=d-h;c+=`<div class="calendar-day other-month"><div class="day-number">${y}</div></div>`}const m=new Date;for(let h=1;h<=r;h++){const y=new Date(a,e,h),w=this.formatDateString(y),k=y.toDateString()===m.toDateString(),D=this.appointments.filter(f=>f.date===w),b=this.workDays.find(f=>f.date===w);if(c+=`<div class="calendar-day ${k?"today":""} ${b?"work-day":""}" data-date="${w}">`,c+=`<div class="day-header">
        <div class="day-number">${h}</div>`,b){const f=b.shift.includes("Ochtend")?"Ochtend":b.shift.includes("Middag")?"Middag":b.shift.includes("Nacht")?"Nacht":"Werk";c+=`<div class="work-day-label">${f}</div>`}c+="</div>",c+='<div class="day-appointments">',D.slice(0,3).forEach(f=>{c+=`<div class="appointment-pill ${f.status}" data-id="${f.id}">
          ${f.time} ${f.name}
        </div>`}),D.length>3&&(c+=`<div class="appointment-pill" style="background: #E5E7EB; color: #6B7280;">
          +${D.length-3} ${this.translate("more")}
        </div>`),c+="</div></div>"}const g=u+r,v=g%7===0?0:7-g%7;for(let h=1;h<=v;h++)c+=`<div class="calendar-day other-month"><div class="day-number">${h}</div></div>`;c+="</div>",t.innerHTML=c,document.querySelectorAll(".calendar-day").forEach(h=>{h.addEventListener("click",y=>{const w=h.dataset.date;if(w)if(y.target.classList.contains("appointment-pill")&&y.target.dataset.id){const k=y.target.dataset.id;this.showAppointmentModal(k)}else{const k=this.appointments.filter(D=>D.date===w);k.length>0&&this.showDayAppointmentsModal(w,k)}})})}renderWeekView(t){const a=this.getWeekStart(this.currentDate),e=Array.from({length:11},(i,o)=>`${8+o}:00`);let n='<div class="week-grid">';n+='<div class="time-slot"></div>';for(let i=0;i<7;i++){const o=new Date(a);o.setDate(o.getDate()+i);const s=o.toDateString()===new Date().toDateString();n+=`<div class="week-header-cell ${s?"today":""}">
        ${o.toLocaleDateString("nl-NL",{weekday:"short",day:"numeric"})}
      </div>`}e.forEach(i=>{n+=`<div class="time-slot">${i}</div>`;for(let o=0;o<7;o++){const s=new Date(a);s.setDate(s.getDate()+o);const r=this.formatDateString(s),d=parseInt(i.split(":")[0]),u=this.appointments.filter(c=>c.date!==r?!1:parseInt(c.time.split(":")[0])===d);n+=`<div class="week-day-cell" data-date="${r}" data-hour="${i}">`,u.forEach(c=>{n+=`<div class="appointment-pill ${c.status}" data-id="${c.id}">
            ${c.time} ${c.name}
          </div>`}),n+="</div>"}}),n+="</div>",t.innerHTML=n,document.querySelectorAll(".appointment-pill").forEach(i=>{i.addEventListener("click",()=>{const o=i.dataset.id;o&&this.showAppointmentModal(o)})})}getWeekStart(t){const a=new Date(t),e=a.getDay(),n=a.getDate()-e+(e===0?-6:1);return new Date(a.setDate(n))}setupAppointments(){const t=document.getElementById("status-filter"),a=document.getElementById("date-filter"),e=document.getElementById("time-filter");t&&t.addEventListener("change",()=>{this.renderAppointments(t.value)}),a&&a.addEventListener("change",()=>{this.renderAppointments(t?t.value:"all")}),e&&e.addEventListener("change",()=>{this.renderAppointments(t?t.value:"all")})}renderAppointments(t="all"){const a=document.getElementById("appointments-list");let e=this.appointments;t!=="afgerond"&&(e=e.filter(s=>s.status!=="afgerond")),t!=="all"&&t!=="afgerond"?e=e.filter(s=>s.status===t):t==="afgerond"&&(e=this.appointments.filter(s=>s.status==="afgerond"));const n=document.getElementById("date-filter");if(n&&n.value!=="all"){const s=new Date;s.setHours(0,0,0,0),e=e.filter(r=>{const[d,u,c]=r.date.split("-").map(Number),p=new Date(d,u-1,c);switch(p.setHours(0,0,0,0),n.value){case"today":return p.getTime()===s.getTime();case"tomorrow":const m=new Date(s);return m.setDate(m.getDate()+1),p.getTime()===m.getTime();case"this-week":const g=new Date(s);return g.setDate(g.getDate()+7),p>=s&&p<g;case"next-week":const v=new Date(s);v.setDate(v.getDate()+7);const h=new Date(s);return h.setDate(h.getDate()+14),p>=v&&p<h;default:return!0}})}const i=document.getElementById("time-filter");if(i&&i.value!=="all"&&(e=e.filter(s=>{const r=parseInt(s.time.split(":")[0]);return i.value==="morning"?r>=9&&r<12:i.value==="afternoon"?r>=12&&r<17:!0})),e.sort((s,r)=>s.date===r.date?s.time.localeCompare(r.time):s.date.localeCompare(r.date)),e.length===0){a.innerHTML='<p class="empty-state">Geen afspraken gevonden</p>';return}let o="";e.forEach(s=>{const[r,d,u]=s.date.split("-").map(Number),p=new Date(r,d-1,u).toLocaleDateString("nl-NL",{weekday:"short",day:"numeric",month:"short"}),m={"nieuwe-aanvraag":"Nieuw",bevestigd:"Bevestigd","in-behandeling":"Bezig",afgerond:"Klaar"}[s.status];o+=`<div class="appointment-card ${s.status}" data-id="${s.id}">
        <div class="appointment-header">
          <div class="appointment-info">
            <h3>${s.name}</h3>
            <div class="appointment-meta">
              <span>ğŸ“… ${p}</span>
              <span>ğŸ• ${s.time}</span>
              ${s.service?`<span>ğŸ“‹ ${s.service}</span>`:""}
              ${s.kenteken?`<span>ğŸš— ${s.kenteken}</span>`:""}
            </div>
          </div>
          <span class="status-badge ${s.status}">${m}</span>
        </div>
        ${s.notes?`<div class="appointment-body">
          <p>${s.notes}</p>
        </div>`:""}
      </div>`}),a.innerHTML=o,document.querySelectorAll(".appointment-card").forEach(s=>{s.addEventListener("click",()=>{this.showAppointmentModal(s.dataset.id)})})}setupEmails(){const t=document.getElementById("add-manual-email-btn"),a=document.getElementById("manual-email-form"),e=document.getElementById("cancel-manual-entry"),n=document.getElementById("manual-entry-form"),i=document.getElementById("kenteken-lookup-btn"),o=document.getElementById("customer-kenteken"),s=document.getElementById("preferred-date");if(s){const r=new Date().toISOString().split("T")[0];s.setAttribute("min",r)}t&&t.addEventListener("click",()=>{a.style.display=a.style.display==="none"?"block":"none",a.style.display==="block"&&document.getElementById("customer-name").focus()}),e&&e.addEventListener("click",()=>{a.style.display="none",n.reset(),document.getElementById("rdw-info").style.display="none"}),n&&n.addEventListener("submit",async r=>{r.preventDefault(),await this.addManualEmail(new FormData(n))}),i&&o&&(i.addEventListener("click",async()=>{await this.lookupKenteken()}),o.addEventListener("keypress",async r=>{r.key==="Enter"&&(r.preventDefault(),await this.lookupKenteken())}),o.addEventListener("input",r=>{const d=r.target.value.toUpperCase().replace(/[^A-Z0-9]/g,"");d.length>=6&&(r.target.value=B(d))}))}async lookupKenteken(){const t=document.getElementById("customer-kenteken"),a=document.getElementById("rdw-info"),e=document.getElementById("kenteken-lookup-btn"),n=t.value.trim();if(!n||n.length<4){a.style.display="block",a.className="rdw-info error",a.innerHTML="âš ï¸ Voer een geldig kenteken in (minimaal 4 tekens)";return}a.style.display="block",a.className="rdw-info loading",a.innerHTML='<div style="display: flex; align-items: center; gap: 0.5rem;"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="animation: spin 1s linear infinite;"><circle cx="12" cy="12" r="10" opacity="0.25"/><path d="M12 2a10 10 0 0 1 10 10" opacity="0.75"/></svg> Zoeken in RDW database...</div>',e.disabled=!0;try{const i=await K(n),o=await G(n);t.value=B(i.kenteken),this.currentVehicleInfo=i,a.className="rdw-info success";let s=`<div class="rdw-info-grid">
        <div class="rdw-info-row">
          <span class="rdw-info-label">Merk</span>
          <span class="rdw-info-value">${i.merk||"-"}</span>
        </div>
        <div class="rdw-info-row">
          <span class="rdw-info-label">Model</span>
          <span class="rdw-info-value">${i.handelsbenaming||"-"}</span>
        </div>
        <div class="rdw-info-row">
          <span class="rdw-info-label">Brandstof</span>
          <span class="rdw-info-value">${i.brandstof_omschrijving||i.brandstof||"-"}</span>
        </div>
        <div class="rdw-info-row">
          <span class="rdw-info-label">Kleur</span>
          <span class="rdw-info-value">${i.eerste_kleur||"-"}</span>
        </div>
        <div class="rdw-info-row">
          <span class="rdw-info-label">Bouwjaar</span>
          <span class="rdw-info-value">${i.datum_eerste_toelating?i.datum_eerste_toelating.substring(0,4):"-"}</span>
        </div>
        <div class="rdw-info-row">
          <span class="rdw-info-label">APK Vervaldatum</span>
          <span class="rdw-info-value">${i.vervaldatum_apk?S(i.vervaldatum_apk):"-"}</span>
        </div>
      </div>`;if(i.vervaldatum_apk){const r=U(i.vervaldatum_apk);let d;const u=i.vervaldatum_apk;if(u.length===8&&!u.includes("-")){const m=parseInt(u.substring(0,4)),g=parseInt(u.substring(4,6)),v=parseInt(u.substring(6,8));d=new Date(m,g-1,v)}else d=new Date(i.vervaldatum_apk);d<new Date?s+=`<div class="rdw-apk-warning rdw-apk-expired">
            âš ï¸ APK is verlopen! De APK is verlopen op ${S(i.vervaldatum_apk)}
          </div>`:r&&(s+=`<div class="rdw-apk-warning">
            âš ï¸ APK verloopt binnenkort op ${S(i.vervaldatum_apk)}
          </div>`)}a.innerHTML=s}catch(i){console.error("RDW Lookup Error:",i),a.className="rdw-info error",a.innerHTML=`âš ï¸ ${i.message||"Kenteken niet gevonden in RDW database"}`,this.currentVehicleInfo=null}finally{e.disabled=!1}}async addManualEmail(t){const a=t.get("message")||"Geen extra opmerkingen",e={id:String(Date.now()),name:t.get("name"),email:t.get("email"),phone:t.get("phone")||"",kenteken:t.get("kenteken")||"",service:t.get("service"),subject:`${t.get("service")} - ${t.get("contactMethod")}`,message:a,description:a,contactMethod:t.get("contactMethod"),preferredDate:t.get("preferredDate")||"",preferredTime:t.get("preferredTime")||"",vehicleInfo:this.currentVehicleInfo||null,created_at:new Date().toISOString(),read:!1,manualEntry:!0};this.emails.unshift(e);try{await q(e),this.showNotification(this.translate("emailAddedSuccess")||"Contact succesvol toegevoegd aan de lijst!")}catch(n){console.error("Error saving manual email:",n),this.saveData("emails",this.emails),this.showNotification(this.translate("emailAddedSuccess")||"Contact succesvol toegevoegd!")}this.renderEmails(),this.updateStats(),document.getElementById("manual-email-form").style.display="none",document.getElementById("manual-entry-form").reset(),document.getElementById("rdw-info").style.display="none",this.currentVehicleInfo=null}renderEmails(){const t=document.getElementById("emails-container");if(this.emails.length===0){t.innerHTML=`<p class="empty-state">${this.translate("noEmailsReceived")}</p>`;return}let a="";this.emails.forEach(e=>{const i=new Date(e.created_at).toLocaleDateString(this.getLocale(),{day:"numeric",month:"short",hour:"2-digit",minute:"2-digit"});this.appointments.some(o=>o.emailId==e.id),a+=`<div class="email-card ${e.read?"":"unread"}" data-id="${e.id}">
        <div class="email-main-row">
          <div class="email-left">
            <div class="email-info-block">
              <h3 class="sender-name">
                ${e.name}
                ${e.read?"":'<span class="unread-dot"></span>'}
              </h3>
              <div class="email-meta">
                <span>ğŸ“§ ${e.email}</span>
                ${e.phone?`<span>ğŸ“ ${e.phone}</span>`:""}
                ${e.kenteken?`<span>ğŸš— ${e.kenteken}</span>`:""}
                <span class="subject-badge">${e.subject}</span>
              </div>
              <p class="email-message">${e.message||e.description||""}</p>
            </div>
          </div>
          <div class="email-right">
            <span class="email-date">${i}</span>
            <div class="email-actions">
              <button class="action-btn btn-email-schedule" onclick="event.stopPropagation(); dashboard.createAppointmentFromEmail('${e.id}')" title="${this.translate("schedule")}">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
                  <line x1="16" y1="2" x2="16" y2="6"/>
                  <line x1="8" y1="2" x2="8" y2="6"/>
                  <line x1="3" y1="10" x2="21" y2="10"/>
                </svg>
                <span>${this.translate("schedule")}</span>
              </button>
              <button class="action-btn btn-email-edit" onclick="event.stopPropagation(); dashboard.showEmailDetails('${e.id}')" title="${this.translate("viewDetails")}">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/>
                  <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/>
                </svg>
              </button>
              <button class="action-btn btn-email-reject" onclick="event.stopPropagation(); dashboard.archiveEmail('${e.id}')" title="${this.translate("reject")}">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <line x1="18" y1="6" x2="6" y2="18"/>
                  <line x1="6" y1="6" x2="18" y2="18"/>
                </svg>
              </button>
            </div>
          </div>
        </div>
      </div>`}),t.innerHTML=a}async createAppointmentFromEmail(t){const a=this.emails.find(s=>s.id==t);if(!a)return;if(this.appointments.find(s=>s.emailId==t)){this.showNotification(this.translate("appointmentAlreadyExists"),"warning");return}const n=a.preferredDate||this.formatDateString(new Date),i=a.preferredTime||"09:00",o={id:String(Date.now()),name:a.name,email:a.email,phone:a.phone||"",kenteken:a.kenteken||"",date:n,time:i,service:a.service||a.subject,notes:a.message||a.description||"",status:"nieuwe-aanvraag",createdFrom:"email",emailId:a.id};try{await T(o),this.appointments.push(o),await A(t),this.emails=this.emails.filter(s=>s.id!=t)}catch(s){console.error("Error creating appointment:",s),this.appointments.push(o),this.saveData("appointments",this.appointments),this.emails=this.emails.filter(r=>r.id!=t),this.saveData("emails",this.emails)}this.updateStats(),this.renderEmails(),this.renderCalendar(),this.renderAppointments(),this.showNotification(this.translate("appointmentCreated")),this.showAppointmentModal(o.id)}async quickPlanToday(t,a){const e=this.emails.find(r=>r.id==t);if(!e)return;if(this.appointments.find(r=>r.emailId==t)){this.showNotification(this.translate("appointmentAlreadyExists"),"warning");return}a&&a.querySelector("span")&&(a.classList.add("btn-collapsed"),a.style.pointerEvents="none");const i=this.formatDateString(new Date),o=this.findNextAvailableTime(i),s={id:String(Date.now()),name:e.name,email:e.email,phone:e.phone,kenteken:e.kenteken||"",date:i,time:o,service:e.subject,notes:e.message,status:"bevestigd",createdFrom:"email",emailId:e.id};try{await T(s),this.appointments.push(s),await A(t),this.emails=this.emails.filter(r=>r.id!=t)}catch(r){console.error("Error creating appointment:",r),this.appointments.push(s),this.saveData("appointments",this.appointments),this.emails=this.emails.filter(d=>d.id!=t),this.saveData("emails",this.emails)}this.updateStats(),this.renderEmails(),this.renderCalendar(),this.renderAppointments(),this.showNotification(this.translate("appointmentScheduledToday",{time:o}),"success")}async quickPlanTomorrow(t){const a=this.emails.find(r=>r.id==t);if(!a)return;if(this.appointments.find(r=>r.emailId==t)){this.showNotification("Er bestaat al een afspraak voor dit bericht","warning");return}const n=new Date;n.setDate(n.getDate()+1);const i=this.formatDateString(n),o=this.findNextAvailableTime(i),s={id:String(Date.now()),name:a.name,email:a.email,phone:a.phone,kenteken:a.kenteken||"",date:i,time:o,service:a.subject,notes:a.message,status:"bevestigd",createdFrom:"email",emailId:a.id};try{await T(s),this.appointments.push(s),await A(t),this.emails=this.emails.filter(r=>r.id!=t)}catch(r){console.error("Error creating appointment:",r),this.appointments.push(s),this.saveData("appointments",this.appointments),this.emails=this.emails.filter(d=>d.id!=t),this.saveData("emails",this.emails)}this.updateStats(),this.renderEmails(),this.renderCalendar(),this.renderAppointments(),this.showNotification(this.translate("appointmentScheduledTomorrow",{time:o}),"success")}findNextAvailableTime(t){const a=["09:00","10:00","11:00","12:00","13:00","14:00","15:00","16:00"],e=this.appointments.filter(n=>n.date===t&&n.status!=="afgerond");for(let n of a)if(!e.some(o=>o.time===n))return n;return"17:00"}markAsRead(t){const a=this.emails.find(e=>e.id==t);a&&(a.read=!0,this.saveData("emails",this.emails),this.renderEmails(),this.updateStats())}archiveEmail(t){this.showConfirmDialog("Weet je zeker dat je deze aanvraag wilt afwijzen?",()=>{this.emails=this.emails.filter(a=>a.id!=t),this.saveData("emails",this.emails),this.renderEmails(),this.updateStats(),this.showNotification(this.translate("requestRejectedDeleted"))})}showEmailDetails(t){const a=this.emails.find(r=>r.id==t);if(!a)return;a.read=!0,this.saveData("emails",this.emails),this.updateStats(),this.renderEmails();const e=document.getElementById("appointment-modal"),n=document.getElementById("modal-title"),i=document.getElementById("modal-body"),s=new Date(a.created_at).toLocaleDateString("nl-NL",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"});n.textContent=`${this.translate("requestFrom")} ${a.name}`,i.innerHTML=`
      <div class="detail-grid">
        <div class="detail-row">
          <span class="detail-label">${this.translate("name")}</span>
          <span class="detail-value">${a.name}</span>
        </div>
        <div class="detail-row">
          <span class="detail-label">${this.translate("email")}</span>
          <span class="detail-value">${a.email}</span>
        </div>
        <div class="detail-row">
          <span class="detail-label">${this.translate("phone")}</span>
          <span class="detail-value">${a.phone||"-"}</span>
        </div>
        <div class="detail-row">
          <span class="detail-label">${this.translate("licensePlate")}</span>
          <span class="detail-value">${a.kenteken||"-"}</span>
        </div>
        <div class="detail-row">
          <span class="detail-label">${this.translate("subject")}</span>
          <span class="detail-value">${a.subject}</span>
        </div>
        <div class="detail-row">
          <span class="detail-label">${this.translate("receivedOn")}</span>
          <span class="detail-value">${s}</span>
        </div>
        <div class="detail-row">
          <span class="detail-label">${this.translate("message")}</span>
          <div class="detail-value message-box">${a.message||a.description||"-"}</div>
        </div>
      </div>
      
      <div class="modal-actions">
        <button class="action-btn primary" onclick="dashboard.quickPlanToday('${a.id}'); document.getElementById('appointment-modal').classList.remove('active');">
          ${this.translate("acceptScheduleToday")}
        </button>
        <button class="action-btn secondary" onclick="dashboard.createAppointmentFromEmail('${a.id}')">
          ${this.translate("chooseDate")}
        </button>
        <button class="action-btn danger" onclick="dashboard.archiveEmail('${a.id}'); document.getElementById('appointment-modal').classList.remove('active');">
          ${this.translate("reject")}
        </button>
      </div>
    `,e.classList.add("active")}setupModal(){const t=document.getElementById("appointment-modal");document.getElementById("modal-close").addEventListener("click",()=>{t.classList.remove("active")}),t.addEventListener("click",i=>{i.target===t&&t.classList.remove("active")});const e=document.getElementById("day-appointments-modal"),n=document.getElementById("day-modal-close");e&&n&&(n.addEventListener("click",()=>{e.classList.remove("active")}),e.addEventListener("click",i=>{i.target===e&&e.classList.remove("active")}))}showDayAppointmentsModal(t,a){const e=document.getElementById("day-appointments-modal"),n=document.getElementById("day-modal-title"),i=document.getElementById("day-modal-body");if(!e||!n||!i)return;const[o,s,r]=t.split("-").map(Number),u=new Date(o,s-1,r).toLocaleDateString(this.getLocale(),{weekday:"long",year:"numeric",month:"long",day:"numeric"});n.textContent=`${this.translate("appointmentsOn")} ${u}`;const c=[...a].sort((m,g)=>{const v=m.time.split(":").map(Number),h=g.time.split(":").map(Number);return v[0]*60+v[1]-(h[0]*60+h[1])});let p='<div class="day-appointments-list">';c.forEach(m=>{const g=this.getStatusText(m.status);p+=`
        <div class="day-appointment-item" data-id="${m.id}">
          <div class="day-appointment-time">${m.time}</div>
          <div class="day-appointment-details">
            <div class="day-appointment-name">${m.name}</div>
            <div class="day-appointment-info">
              <span class="status-badge ${m.status}">${g}</span>
              ${m.service?`<span class="day-appointment-subject">${m.service}</span>`:""}
            </div>
          </div>
          <button class="day-appointment-view" onclick="dashboard.showAppointmentModal('${m.id}')">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M9 18l6-6-6-6"/>
            </svg>
          </button>
        </div>
      `}),p+="</div>",i.innerHTML=p,e.classList.add("active")}showAppointmentModal(t,a=!1){const e=this.appointments.find(g=>g.id==t);if(!e)return;const n=document.getElementById("day-appointments-modal");n&&n.classList.remove("active");const i=document.getElementById("appointment-modal"),o=document.getElementById("modal-title"),s=document.getElementById("modal-body"),[r,d,u]=e.date.split("-").map(Number),p=new Date(r,d-1,u).toLocaleDateString("nl-NL",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),m={"nieuwe-aanvraag":this.translate("statusNew"),bevestigd:this.translate("statusConfirmed"),"in-behandeling":this.translate("statusInProgress"),afgerond:this.translate("statusCompleted")}[e.status];o.textContent=a?this.translate("edit")+" - "+e.name:`${this.translate("appointmentDetails")} - ${e.name}`,a?s.innerHTML=`
        <div class="detail-grid">
          <div class="detail-row">
            <span class="detail-label">${this.translate("status")}</span>
            <span class="status-badge ${e.status}">${m}</span>
          </div>
          <div class="detail-row">
            <label class="detail-label" for="edit-name">${this.translate("name")}</label>
            <input type="text" id="edit-name" class="form-control" value="${e.name}" required>
          </div>
          <div class="detail-row">
            <span class="detail-label">${this.translate("email")}</span>
            <span class="detail-value">${e.email||"-"}</span>
          </div>
          <div class="detail-row">
            <span class="detail-label">${this.translate("phone")}</span>
            <span class="detail-value">${e.phone||"-"}</span>
          </div>
          <div class="detail-row">
            <span class="detail-label">${this.translate("licensePlate")}</span>
            <span class="detail-value">${e.kenteken||"-"}</span>
          </div>
          <div class="detail-row">
            <span class="detail-label">${this.translate("service")}</span>
            <span class="detail-value">${e.service||"-"}</span>
          </div>
          <div class="detail-row">
            <label class="detail-label" for="edit-date">${this.translate("date")}</label>
            <input type="date" id="edit-date" class="form-control" value="${e.date}" required>
          </div>
          <div class="detail-row">
            <label class="detail-label" for="edit-time">${this.translate("time")}</label>
            <input type="time" id="edit-time" class="form-control" value="${e.time}" required>
          </div>
          <div class="detail-row">
            <span class="detail-label">${this.translate("notes")}</span>
            <div class="detail-value message-box">${e.notes||""}</div>
          </div>
        </div>
        
        <div class="modal-actions">
          <button class="action-btn primary" onclick="dashboard.saveAppointmentChanges('${e.id}')">
            ${this.translate("save")}
          </button>
          <button class="action-btn secondary" onclick="dashboard.showAppointmentModal('${e.id}', false)">
            ${this.translate("cancel")}
          </button>
        </div>
      `:s.innerHTML=`
        <div class="detail-grid">
          <div class="detail-row">
            <span class="detail-label">${this.translate("status")}</span>
            <span class="status-badge ${e.status}">${m}</span>
          </div>
          <div class="detail-row">
            <span class="detail-label">${this.translate("name")}</span>
            <span class="detail-value">${e.name}</span>
          </div>
          <div class="detail-row">
            <span class="detail-label">${this.translate("email")}</span>
            <span class="detail-value">${e.email||"-"}</span>
          </div>
          <div class="detail-row">
            <span class="detail-label">${this.translate("phone")}</span>
            <span class="detail-value">${e.phone||"-"}</span>
          </div>
          <div class="detail-row">
            <span class="detail-label">${this.translate("licensePlate")}</span>
            <span class="detail-value">${e.kenteken||"-"}</span>
          </div>
          <div class="detail-row">
            <span class="detail-label">${this.translate("service")}</span>
            <span class="detail-value">${e.service||"-"}</span>
          </div>
          <div class="detail-row">
            <span class="detail-label">${this.translate("date")}</span>
            <span class="detail-value">${p}</span>
          </div>
          <div class="detail-row">
            <span class="detail-label">${this.translate("time")}</span>
            <span class="detail-value">${e.time}</span>
          </div>
          <div class="detail-row">
            <span class="detail-label">${this.translate("message")}</span>
            <div class="detail-value message-box">${e.notes||""}</div>
          </div>
        </div>
        
        <div class="modal-actions">
          <button class="action-btn secondary" onclick="dashboard.showAppointmentModal('${e.id}', true)">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 0.5rem;">
              <path d="M11 4H4a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2v-7"/>
              <path d="M18.5 2.5a2.121 2.121 0 013 3L12 15l-4 1 1-4 9.5-9.5z"/>
            </svg>
            ${this.translate("edit")}
          </button>
          ${e.status==="nieuwe-aanvraag"?`
            <button class="action-btn primary" onclick="dashboard.updateAppointmentStatus('${e.id}', 'bevestigd')">
              ${this.translate("confirm")}
            </button>
          `:""}
          ${e.status==="bevestigd"?`
            <button class="action-btn primary" onclick="dashboard.updateAppointmentStatus('${e.id}', 'in-behandeling')">
              ${this.translate("statusInProgress")}
            </button>
          `:""}
          ${e.status==="in-behandeling"?`
            <button class="action-btn primary" onclick="dashboard.updateAppointmentStatus('${e.id}', 'afgerond')">
              ${this.translate("completed")}
            </button>
          `:""}
          <button class="action-btn danger" onclick="dashboard.confirmDelete('${e.id}')">
            ${this.translate("delete")}
          </button>
        </div>
      `,i.classList.add("active")}async updateAppointmentStatus(t,a){const e=this.appointments.find(n=>n.id==t);if(e){e.status=a;try{await C(t,{status:a}),await this.loadAllData()}catch(i){console.error("Error updating appointment:",i),this.saveData("appointments",this.appointments)}this.updateStats(),this.renderCalendar(),this.renderAppointments(),this.renderDashboard(),this.showAppointmentModal(t);const n={"nieuwe-aanvraag":this.translate("statusNew"),bevestigd:this.translate("statusConfirmed"),"in-behandeling":this.translate("statusInProgress"),afgerond:this.translate("statusCompleted")}[a];this.showNotification(this.translate("statusUpdated",{status:n}))}}saveAppointmentChanges(t){const a=this.appointments.find(s=>s.id==t);if(!a)return;const e=document.getElementById("edit-name").value.trim(),n=document.getElementById("edit-date").value,i=document.getElementById("edit-time").value;if(!e||!n||!i){this.showNotification(this.translate("fillAllFields"),"error");return}if(this.appointments.some(s=>s.id!=t&&s.date===n&&s.time===i&&s.status!=="afgerond")){this.showConfirmDialog("Er is al een afspraak op deze datum en tijd. Toch opslaan?",()=>{this.performSaveAppointment(a,e,n,i)});return}this.performSaveAppointment(a,e,n,i)}async performSaveAppointment(t,a,e,n){t.name=a,t.date=e,t.time=n;try{await C(t.id,{name:a,date:e,time:n}),await this.loadAllData()}catch(i){console.error("Error updating appointment:",i),this.saveData("appointments",this.appointments)}this.updateStats(),this.renderCalendar(),this.renderAppointments(),this.renderDashboard(),this.showAppointmentModal(t.id,!1),this.showNotification(this.translate("appointmentUpdated"))}confirmDelete(t){this.showConfirmDialog(this.translate("deleteAppointmentConfirm"),()=>{this.deleteAppointment(t)})}async deleteAppointment(t){try{await _(t),this.appointments=this.appointments.filter(e=>e.id!=t)}catch(e){console.error("Error deleting appointment:",e),this.appointments=this.appointments.filter(n=>n.id!=t),this.saveData("appointments",this.appointments)}document.getElementById("appointment-modal").classList.remove("active"),this.updateStats(),this.renderCalendar(),this.renderAppointments(),this.renderDashboard(),this.showNotification(this.translate("appointmentDeleted"))}async archiveEmail(t){this.showConfirmDialog(this.translate("deleteEmailConfirm"),async()=>{try{await A(t),this.emails=this.emails.filter(a=>a.id!=t)}catch(a){console.error("Error deleting email:",a),this.emails=this.emails.filter(e=>e.id!=t),this.saveData("emails",this.emails)}this.renderEmails(),this.updateStats(),this.showNotification(this.translate("emailDeleted"))})}setupSettings(){const t=document.getElementById("clear-data-btn"),a=document.getElementById("import-ics-btn"),e=document.getElementById("ics-file-input");a&&e&&(a.addEventListener("click",()=>{e.click()}),e.addEventListener("change",async n=>{const i=n.target.files[0];if(!i)return;const o=document.getElementById("import-status");try{const s=await i.text(),r=this.parseICalendar(s);if(r.length>0)try{await V(r),this.workDays=r,this.renderCalendar(),o&&(o.textContent=`âœ“ ${r.length} werkdagen geÃ¯mporteerd`,o.style.color="#10B981",setTimeout(()=>o.textContent="",5e3)),this.showNotification(this.translate("workDaysAdded",{count:r.length}))}catch(d){console.error("Database error:",d),this.workDays=r,this.saveData("workDays",this.workDays),this.renderCalendar(),o&&(o.textContent=`âœ“ ${r.length} werkdagen geÃ¯mporteerd (lokaal)`,o.style.color="#10B981",setTimeout(()=>o.textContent="",5e3))}else o&&(o.textContent="âœ— Geen gebeurtenissen gevonden",o.style.color="#EF4444",setTimeout(()=>o.textContent="",5e3));e.value=""}catch(s){console.error("Error importing iCalendar:",s),o&&(o.textContent="âœ— Fout bij importeren",o.style.color="#EF4444",setTimeout(()=>o.textContent="",5e3))}})),t&&t.addEventListener("click",()=>{this.showConfirmDialog(this.translate("clearAllDataConfirm"),()=>{localStorage.removeItem("ash_appointments"),localStorage.removeItem("ash_emails"),this.appointments=[],this.emails=[],this.updateStats(),this.renderCalendar(),this.renderAppointments(),this.renderEmails(),this.renderDashboard(),this.showNotification(this.translate("allDataCleared"))})})}parseICalendar(t){const a=[],e=t.split(/\r\n|\n|\r/);let n=null;for(let i=0;i<e.length;i++){const o=e[i].trim();if(o==="BEGIN:VEVENT")n={};else if(o==="END:VEVENT"&&n)n.start&&n.description&&a.push({date:n.start,shift:n.description,startTime:n.startTime,endTime:n.endTime}),n=null;else if(n)if(o.startsWith("DTSTART")){const s=o.match(/(\d{4})(\d{2})(\d{2})T(\d{2})(\d{2})/);s&&(n.start=`${s[1]}-${s[2]}-${s[3]}`,n.startTime=`${s[4]}:${s[5]}`)}else if(o.startsWith("DTEND")){const s=o.match(/(\d{4})(\d{2})(\d{2})T(\d{2})(\d{2})/);s&&(n.endTime=`${s[4]}:${s[5]}`)}else o.startsWith("DESCRIPTION:")&&(n.description=o.substring(12))}return a}showConfirmDialog(t,a){const e=document.querySelector(".confirm-dialog");e&&e.remove();const n=document.createElement("div");n.className="confirm-dialog",n.innerHTML=`
      <div class="confirm-dialog-content">
        <div class="confirm-dialog-icon">
          <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="10"/>
            <line x1="12" y1="8" x2="12" y2="12"/>
            <line x1="12" y1="16" x2="12.01" y2="16"/>
          </svg>
        </div>
        <h3>${this.translate("confirmation")}</h3>
        <p>${t}</p>
        <div class="confirm-dialog-actions">
          <button class="action-btn secondary" id="confirm-cancel">${this.translate("cancel")}</button>
          <button class="action-btn danger" id="confirm-yes">${this.translate("yesContinue")}</button>
        </div>
      </div>
    `,document.body.appendChild(n),setTimeout(()=>n.classList.add("show"),10),document.getElementById("confirm-cancel").addEventListener("click",()=>{n.classList.remove("show"),setTimeout(()=>n.remove(),300)}),document.getElementById("confirm-yes").addEventListener("click",()=>{n.classList.remove("show"),setTimeout(()=>n.remove(),300),a()}),n.addEventListener("click",i=>{i.target===n&&(n.classList.remove("show"),setTimeout(()=>n.remove(),300))})}updateStats(){const t=this.appointments.length,a=this.appointments.filter(m=>m.status==="afgerond").length,e=this.emails.length,n=this.emails.filter(m=>!m.read).length,i=this.appointments.filter(m=>m.status!=="afgerond").length;document.getElementById("stat-total-appointments").textContent=t,document.getElementById("stat-completed").textContent=a,document.getElementById("stat-total-emails").textContent=e,document.getElementById("stat-unread-emails").textContent=n;const o=document.getElementById("appointments-badge"),s=document.getElementById("emails-badge");o&&(o.textContent=i,o.style.display=i>0?"inline-block":"none"),s&&(s.textContent=n,s.style.display=n>0?"inline-block":"none");const r=this.formatDateString(new Date),d=this.appointments.filter(m=>m.date===r&&m.status!=="afgerond").length,u=document.getElementById("quick-new-emails"),c=document.getElementById("quick-today-appointments"),p=document.getElementById("quick-pending");u&&(u.textContent=n||""),c&&(c.textContent=d||""),p&&(p.textContent=newRequests||"")}showNewEmailsOnly(){document.querySelectorAll(".nav-item").forEach(t=>t.classList.remove("active")),document.querySelectorAll(".content-section").forEach(t=>t.classList.remove("active")),document.querySelector('[data-section="emails"]').classList.add("active"),document.getElementById("section-emails").classList.add("active"),this.renderEmails(),setTimeout(()=>{const t=document.querySelector(".email-card.unread");t&&t.scrollIntoView({behavior:"smooth",block:"center"})},100)}showTodayAppointments(){document.querySelectorAll(".nav-item").forEach(e=>e.classList.remove("active")),document.querySelectorAll(".content-section").forEach(e=>e.classList.remove("active")),document.querySelector('[data-section="appointments"]').classList.add("active"),document.getElementById("section-appointments").classList.add("active");const t=document.getElementById("date-filter"),a=document.getElementById("status-filter");t&&(t.value="today"),a&&(a.value="all"),this.renderAppointments()}showCompletedAppointments(){document.querySelectorAll(".nav-item").forEach(a=>a.classList.remove("active")),document.querySelectorAll(".content-section").forEach(a=>a.classList.remove("active")),document.querySelector('[data-section="appointments"]').classList.add("active"),document.getElementById("section-appointments").classList.add("active");const t=document.getElementById("status-filter");t&&(t.value="afgerond",this.renderAppointments("afgerond"))}showPendingActions(){document.querySelectorAll(".nav-item").forEach(e=>e.classList.remove("active")),document.querySelectorAll(".content-section").forEach(e=>e.classList.remove("active")),document.querySelector('[data-section="appointments"]').classList.add("active"),document.getElementById("section-appointments").classList.add("active"),document.querySelectorAll(".filter-btn").forEach(e=>e.classList.remove("active"));const a=document.querySelector('[data-filter="nieuwe-aanvraag"]');a&&a.classList.add("active"),this.renderAppointments("nieuwe-aanvraag")}renderDashboard(){const t=this.formatDateString(new Date),a=this.appointments.filter(o=>o.date===t).sort((o,s)=>o.time.localeCompare(s.time)),e=document.getElementById("appointments-today");if(a.length===0)e.innerHTML=`<p class="empty-state">${this.translate("noAppointmentsToday")}</p>`;else{let o="";a.forEach(s=>{const r=this.getStatusText(s.status);o+=`<div class="appointment-item" onclick="dashboard.showAppointmentModal('${s.id}')">
          <div class="item-header">
            <span class="item-title">${s.name}</span>
            <span class="item-time">${s.time}</span>
          </div>
          <div class="item-description">
            <span class="status-badge ${s.status}">${r}</span> - ${s.notes}
          </div>
        </div>`}),e.innerHTML=o}const n=this.emails.slice(0,5),i=document.getElementById("recent-emails");if(n.length===0)i.innerHTML=`<p class="empty-state">${this.translate("noNewEmailsReceived")}</p>`;else{let o="";n.forEach(s=>{const r=new Date(s.created_at),d=this.getTimeAgo(r);o+=`<div class="email-item" onclick="dashboard.createAppointmentFromEmail('${s.id}')">
          <div class="item-header">
            <span class="item-title">${s.name}</span>
            <span class="item-time">${d}</span>
          </div>
          <div class="item-description">${s.subject}</div>
        </div>`}),i.innerHTML=o}}getTimeAgo(t){const e=Math.floor((new Date-t)/1e3);return e<60?"Zojuist":e<3600?`${Math.floor(e/60)} min geleden`:e<86400?`${Math.floor(e/3600)} uur geleden`:`${Math.floor(e/86400)} dagen geleden`}showNotification(t,a="success"){const e=document.querySelector(".dashboard-toast");e&&e.remove();const n=document.createElement("div");n.className=`dashboard-toast toast-${a}`;const i={success:`<svg class="toast-icon" viewBox="0 0 20 20" fill="currentColor">
        <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
      </svg>`,error:`<svg class="toast-icon" viewBox="0 0 20 20" fill="currentColor">
        <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"/>
      </svg>`,warning:`<svg class="toast-icon" viewBox="0 0 20 20" fill="currentColor">
        <path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd"/>
      </svg>`};n.innerHTML=`
      ${i[a]}
      <span class="toast-message">${t}</span>
      <button class="toast-close" aria-label="Close">
        <svg viewBox="0 0 20 20" fill="currentColor">
          <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"/>
        </svg>
      </button>
    `,document.body.appendChild(n),setTimeout(()=>n.classList.add("show"),10),n.querySelector(".toast-close").addEventListener("click",()=>{n.classList.remove("show"),setTimeout(()=>n.remove(),300)}),setTimeout(()=>{n.parentElement&&(n.classList.remove("show"),setTimeout(()=>n.remove(),300))},5e3)}}const Q=new Z;window.dashboard=Q;
