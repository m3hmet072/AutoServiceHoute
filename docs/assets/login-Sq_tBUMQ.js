import"./base-D7JJuB-E.js";class c{constructor(){this.validCredentials={username:"Muslum",passwordHash:"5994471abb01112afcc18159f6cc74b4f511b99806da59b3caf5a9c173cacfc5"},this.init()}init(){if(this.isLoggedIn()){window.location.href="./dashboard.html";return}this.setupForm(),this.setupPasswordToggle()}setupForm(){const e=document.getElementById("login-form"),t=document.getElementById("error-message"),s=document.getElementById("login-btn");e.addEventListener("submit",async o=>{o.preventDefault();const a=document.getElementById("username").value.trim(),i=document.getElementById("password").value;t.classList.remove("show"),t.textContent="",s.disabled=!0;const n=s.querySelector("span"),d=n.textContent;n.textContent="Bezig met inloggen...";try{const r=await this.hashPassword(i);this.verifyCredentials(a,r)?(this.setSession(),n.textContent="Succesvol!",setTimeout(()=>{window.location.href="./dashboard.html"},500)):(t.textContent="Ongeldige gebruikersnaam of wachtwoord.",t.classList.add("show"),s.disabled=!1,n.textContent=d,document.getElementById("password").value="")}catch(r){console.error("Login error:",r),t.textContent="Er is een fout opgetreden. Probeer het opnieuw.",t.classList.add("show"),s.disabled=!1,n.textContent=d}})}setupPasswordToggle(){const e=document.getElementById("toggle-password"),t=document.getElementById("password");e.addEventListener("click",()=>{const s=t.type==="password"?"text":"password";t.type=s;const o=e.querySelector(".eye-icon");s==="text"?o.innerHTML=`
          <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/>
          <circle cx="12" cy="12" r="3"/>
          <line x1="1" y1="1" x2="23" y2="23"/>
        `:o.innerHTML=`
          <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/>
          <circle cx="12" cy="12" r="3"/>
        `})}async hashPassword(e){const s=new TextEncoder().encode(e),o=await crypto.subtle.digest("SHA-256",s);return Array.from(new Uint8Array(o)).map(n=>n.toString(16).padStart(2,"0")).join("")}verifyCredentials(e,t){return e===this.validCredentials.username&&t===this.validCredentials.passwordHash}setSession(){const e={username:this.validCredentials.username,loginTime:new Date().toISOString(),sessionToken:this.generateSessionToken()};sessionStorage.setItem("ash_session",JSON.stringify(e)),localStorage.setItem("ash_session_check",Date.now().toString())}generateSessionToken(){return Array.from(crypto.getRandomValues(new Uint8Array(32))).map(e=>e.toString(16).padStart(2,"0")).join("")}isLoggedIn(){const e=sessionStorage.getItem("ash_session");if(!e)return!1;try{const t=JSON.parse(e);return t.username&&t.sessionToken}catch{return!1}}}new c;
