import"./base-D7JJuB-E.js";import{l as p}from"./navbar-DIDQeqOs.js";/* empty css                   */import{s as u,t as v}from"./api-D8ZZcVBY.js";let r=null;function l(t,o="success"){const e=document.querySelector(".custom-toast");e&&e.remove();const n=document.createElement("div");n.className=`custom-toast toast-${o}`;const s={success:`<svg class="toast-icon" viewBox="0 0 20 20" fill="currentColor">
      <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
    </svg>`,error:`<svg class="toast-icon" viewBox="0 0 20 20" fill="currentColor">
      <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"/>
    </svg>`,warning:`<svg class="toast-icon" viewBox="0 0 20 20" fill="currentColor">
      <path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd"/>
    </svg>`};n.innerHTML=`
    ${s[o]}
    <span class="toast-message">${t}</span>
    <button class="toast-close" aria-label="Close">
      <svg viewBox="0 0 20 20" fill="currentColor">
        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"/>
      </svg>
    </button>
  `,document.body.appendChild(n),setTimeout(()=>n.classList.add("show"),10),n.querySelector(".toast-close").addEventListener("click",()=>{n.classList.remove("show"),setTimeout(()=>n.remove(),300)}),setTimeout(()=>{n.parentElement&&(n.classList.remove("show"),setTimeout(()=>n.remove(),300))},5e3)}const h="xKnL-OvHIJbJ6pn8s",f="service_38razxb",k="template_aplhulr";function b(t){return t.replace(/[-\s]/g,"").toUpperCase()}async function m(t){const o=b(t),e=document.getElementById("kenteken-status"),n=document.getElementById("vehicle-info");if(o.length<4)return e.textContent="",e.className="kenteken-status",n.style.display="none",!1;try{e.textContent="⏳ Kenteken controleren...",e.className="kenteken-status checking";const s=await fetch(`https://opendata.rdw.nl/resource/m9d7-ebf2.json?kenteken=${o}`,{headers:{Accept:"application/json"}});if(!s.ok)throw new Error("API request failed");const a=await s.json();if(a&&a.length>0){if(r=a[0],e.textContent="✓ Kenteken gevonden in RDW",e.className="kenteken-status valid",document.getElementById("merk").textContent=r.merk||"Onbekend",document.getElementById("handelsbenaming").textContent=r.handelsbenaming||"Onbekend",r.datum_eerste_toelating){const i=r.datum_eerste_toelating,c=`${i.substring(6,8)}-${i.substring(4,6)}-${i.substring(0,4)}`;document.getElementById("datum_eerste_toelating").textContent=c}else document.getElementById("datum_eerste_toelating").textContent="Onbekend";return n.style.display="block",!0}else return e.textContent="✗ Kenteken niet gevonden in RDW database",e.className="kenteken-status invalid",n.style.display="none",r=null,!1}catch(s){return console.error("Error validating kenteken:",s),e.textContent="⚠ Fout bij het controleren van kenteken",e.className="kenteken-status error",n.style.display="none",!1}}function w(t,o){let e;return function(...s){const a=()=>{clearTimeout(e),t(...s)};clearTimeout(e),e=setTimeout(a,o)}}async function y(t){if(typeof emailjs>"u")throw new Error("EmailJS library not loaded");const o={name:t.naam,subject:t.onderwerp,email:t.email,phone:t.telefoon,license:t.kenteken,message:t.bericht};try{return{success:!0,response:await emailjs.send(f,k,o,h)}}catch(e){throw console.error("EmailJS Error:",e),e}}async function E(t){try{const o={id:Date.now().toString(),name:t.naam,email:t.email,phone:t.telefoon,kenteken:t.kenteken,subject:t.onderwerp,message:t.bericht,vehicleInfo:r?JSON.stringify(r):null,read:!1};try{const e=window.location.hostname==="m3hmet072.github.io"||window.location.hostname==="autoservicehoute.nl"?"https://autoservicehoute-production.up.railway.app/api":"http://localhost:3001/api";console.log("Attempting to save email to:",`${e}/emails`);const n=await fetch(`${e}/emails`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});if(console.log("API Response status:",n.status),!n.ok){const a=await n.text();throw console.error("API Error response:",a),new Error("API request failed")}const s=await n.json();console.log("Form data saved to database via API:",s)}catch(e){console.error("API save failed, falling back to localStorage:",e);const n=localStorage.getItem("ash_emails"),s=n?JSON.parse(n):[];s.unshift(o),localStorage.setItem("ash_emails",JSON.stringify(s)),console.log("Form data saved to localStorage (fallback)")}}catch(o){console.error("Error saving to dashboard:",o)}}function I(){const t=document.getElementById("contact-form"),o=document.getElementById("kenteken"),e=document.getElementById("submit-btn");if(!t||!o)return;const n=w(async s=>{await m(s)},500);o.addEventListener("input",s=>{n(s.target.value)}),t.addEventListener("submit",async s=>{s.preventDefault();const a=new FormData(t),i=Object.fromEntries(a.entries());if(!await m(i.kenteken)){l("Het ingevoerde kenteken is niet gevonden in de RDW database. Controleer het kenteken en probeer opnieuw.","error");return}e.disabled=!0,e.textContent="Verzenden...";try{if((await y(i)).success)await E(i),l("Uw bericht is succesvol verzonden! We nemen zo spoedig mogelijk contact met u op.","success"),t.reset(),r=null,document.getElementById("kenteken-status").textContent="",document.getElementById("vehicle-info").style.display="none";else throw new Error("Failed to send email")}catch(d){console.error("Error sending email:",d),l("Er is een fout opgetreden bij het verzenden van uw bericht. Probeer het later opnieuw of neem telefonisch contact met ons op.","error")}finally{e.disabled=!1,e.textContent="Versturen"}})}async function g(){try{let t=sessionStorage.getItem("visitorSessionId");if(t&&(await u()||(console.log("Session expired, creating new session"),t=null)),!t){const e=await v();e.sessionId&&sessionStorage.setItem("visitorSessionId",e.sessionId)}const o=setInterval(()=>{u().catch(console.error)},3e4);window.addEventListener("beforeunload",()=>{clearInterval(o)})}catch(t){console.error("Failed to initialize visitor tracking:",t)}}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",g):g();p();I();
