async function c(t){const e=new TextEncoder().encode(t),s=await crypto.subtle.digest("SHA-256",e);return Array.from(new Uint8Array(s)).map(o=>o.toString(16).padStart(2,"0")).join("")}const d={usernameHash:"a9156affe895aeb451b9d5494c6041d6fa0d6967d4773d3b3445cdfa7e96f833",passwordHash:"ca0a6f784cf5dc4c0921da125237eac74ae286a40a83cdc732b799855f63e336"},i="ash_session",m=1440*60*1e3;function f(){const t=localStorage.getItem(i);if(!t)return!1;try{const e=JSON.parse(t);return Date.now()>e.expiry?(l(),!1):e.authenticated===!0}catch{return l(),!1}}function h(){const t={authenticated:!0,expiry:Date.now()+m,timestamp:Date.now()};localStorage.setItem(i,JSON.stringify(t))}function l(){localStorage.removeItem(i),window.location.href="/login.html"}async function w(t,e){try{const s=await c(t.toLowerCase().trim()),n=await c(e);return s===d.usernameHash&&n===d.passwordHash}catch(s){return console.error("Authentication error:",s),!1}}function u(t){const e=document.getElementById("error-message");e&&(e.textContent=t,e.classList.add("show"),setTimeout(()=>{e.classList.remove("show")},5e3))}window.location.pathname.includes("login.html")&&(f()&&(window.location.href="/dashboard.html"),document.addEventListener("DOMContentLoaded",()=>{const t=document.getElementById("login-form"),e=document.getElementById("toggle-password"),s=document.getElementById("password");e&&s&&e.addEventListener("click",()=>{const n=s.type==="password"?"text":"password";s.type=n;const a=e.querySelector(".eye-icon"),o=e.querySelector(".eye-off-icon");n==="text"?(a.style.display="none",o.style.display="block"):(a.style.display="block",o.style.display="none")}),t&&t.addEventListener("submit",async n=>{n.preventDefault();const a=document.getElementById("username").value,o=document.getElementById("password").value,r=t.querySelector(".login-btn");if(!a||!o){u("Please enter both username and password");return}r.classList.add("loading"),r.disabled=!0,setTimeout(async()=>{await w(a,o)?(h(),window.location.href="/dashboard.html"):(u("Invalid username or password"),r.classList.remove("loading"),r.disabled=!1,document.getElementById("password").value="")},800)})}));window.location.pathname.includes("dashboard.html")&&(f()||(window.location.href="/login.html"));export{f as isAuthenticated,l as logout};
